-- JEAN CARLOS HERNANDEZ BENAVIDES 217034199
-- TAREA:  Integración fuentes de datos saberpro
-- INTELIGENCIA DE NEGOCIOS
-- ==========================================================================
-- INTEGRACION DE DATOS
-- El objetivo es integrar en un solo repositorio(tabla) todas las fuentes de datos 
-- (tablas) del la bodega
-- 
--=========================================================================
-- Crear la tabla unificada a partir de una de ellas
create table sbrpro_2012_2014 as
select * from sbrpro_20141;
-- SELECT 92522
select * from sbrpro_2012_2014 limit 100;
-- ========================================================================
-- Poblamiento de sbrpro_2012_2014 a partir del resto de tablas
-------------------------------------------------------------------------
-- A partir de la tabla sbrpro_20121
------------------------------------------------------------------------
-- 1. se visualiza los atributos comunes de las dos tablas sbrpro_2012-2014 y sbrpro_20121
-- Visualizar los atributos de la tabla sbrpro_2012_2014
select column_name from information_schema.columns where table_name='sbrpro_2012_2014';
-- 96 columnas
-- Visualizar los atributos de la tabla sbrpro_20121
select column_name from information_schema.columns where table_name='sbrpro_20121';
-- 90 columnas
-- Visualizar los atributos comunes de estas dos tablas
select column_name from information_schema.columns where table_name='sbrpro_2012_2014'
intersect
select column_name from information_schema.columns where table_name='sbrpro_20121';
-- 83 atributos comunes
-- =====================================================================================
-- Ingresamos a sbrpro_2012_2014 los datos de las 83 columnas comunes con respecto a sbrpro_20121
insert into sbrpro_2012_2014 
(
estu_trabaja_actualmente,
estu_estadocivil,
estu_porcentajecreditosaprob,
fami_tieneautomovil,
fami_nivel_sisben,
fami_tienelavadora,
estu_genero,
estu_metodo_prgm,
fami_tiene_microondas,
fami_tiene_serviciotv,
estu_cod_cole_mcpio_termino,
estu_cod_mcpio_presentacion,
estu_tipodocumento,
estu_prgm_academico,
estu_otrocole_termino,
estu_valormatriculauniversidad,
estu_pagomatriculapadres,
mod_ingles_punt,
estu_nivel_prgm_academico,
estu_nucleo_pregrado,
estu_cod_reside_mcpio,
estu_mcpio_reside,
inst_caracter_academico,
estu_tipodocumentosb11,
estu_depto_presentacion,
estu_inst_departamento,
fami_personashogar,
estu_privado_libertad,
estu_cod_reside_depto,
mod_razona_cuantitat_punt,
estu_pagomatriculabeca,
estu_ano_examenestado_sb11,
estu_depto_reside,
estu_pagomatriculapropio,
mod_competen_ciudada_punt,
mod_ingles_desem,
fami_estratovivienda,
estu_inst_municipio,
fami_ocupacionmadre,
estu_nacionalidad,
periodo,
estu_estudiante,
estu_snies_prgmacademico,
fami_tiene_nevera,
fami_tieneinternet,
estu_consecutivo,
fami_tiene_dvd,
fami_tiene_horno,
fami_numpersonasacargo,
estu_semestre_examenestadosb11,
mod_comuni_escrita_punt,
mod_lectura_critica_punt,
estu_cole_termino,
estu_estadoinvestigacion,
fami_educacionpadre,
estu_tituloobtenidobachiller,
estu_inst_codmunicipio,
fami_educacionmadre,
estu_mcpio_presentacion,
fami_cuartoshogar,
estu_pagomatriculacredito,
gruporeferencia,
estu_pais_reside,
fami_cabezafamilia,
fami_pisos_hogar,
estu_prgm_codmunicipio,
inst_nombre_institucion,
estu_coddane_cole_termino,
estu_cod_depto_presentacion,
fami_hogaractual,
estu_prgm_departamento,
fami_tiene_celular,
fami_ocupacionpadre,
estu_prgm_municipio,
mod_comuni_escrita_desem,
fami_telefono,
fami_ingreso_fmiliar_mensual,
estu_semestrecursa,
estu_fechanacimiento,
inst_origen,
inst_cod_institucion,
estu_horassemanatrabaja,
fami_tienecomputador
)
(
select 
estu_trabaja_actualmente,
estu_estadocivil,
estu_porcentajecreditosaprob,
fami_tieneautomovil,
fami_nivel_sisben,
fami_tienelavadora,
estu_genero,
estu_metodo_prgm,
fami_tiene_microondas,
fami_tiene_serviciotv,
estu_cod_cole_mcpio_termino,
estu_cod_mcpio_presentacion,
estu_tipodocumento,
estu_prgm_academico,
estu_otrocole_termino,
estu_valormatriculauniversidad,
estu_pagomatriculapadres,
mod_ingles_punt,
estu_nivel_prgm_academico,
estu_nucleo_pregrado,
estu_cod_reside_mcpio,
estu_mcpio_reside,
inst_caracter_academico,
estu_tipodocumentosb11,
estu_depto_presentacion,
estu_inst_departamento,
fami_personashogar,
estu_privado_libertad,
estu_cod_reside_depto,
mod_razona_cuantitat_punt,
estu_pagomatriculabeca,
estu_ano_examenestado_sb11,
estu_depto_reside,
estu_pagomatriculapropio,
mod_competen_ciudada_punt,
mod_ingles_desem,
fami_estratovivienda,
estu_inst_municipio,
fami_ocupacionmadre,
estu_nacionalidad,
periodo,
estu_estudiante,
estu_snies_prgmacademico,
fami_tiene_nevera,
fami_tieneinternet,
estu_consecutivo,
fami_tiene_dvd,
fami_tiene_horno,
fami_numpersonasacargo,
estu_semestre_examenestadosb11,
mod_comuni_escrita_punt,
mod_lectura_critica_punt,
estu_cole_termino,
estu_estadoinvestigacion,
fami_educacionpadre,
estu_tituloobtenidobachiller,
estu_inst_codmunicipio,
fami_educacionmadre,
estu_mcpio_presentacion,
fami_cuartoshogar,
estu_pagomatriculacredito,
gruporeferencia,
estu_pais_reside,
fami_cabezafamilia,
fami_pisos_hogar,
estu_prgm_codmunicipio,
inst_nombre_institucion,
estu_coddane_cole_termino,
estu_cod_depto_presentacion,
fami_hogaractual,
estu_prgm_departamento,
fami_tiene_celular,
fami_ocupacionpadre,
estu_prgm_municipio,
mod_comuni_escrita_desem,
fami_telefono,
fami_ingreso_fmiliar_mensual,
estu_semestrecursa,
estu_fechanacimiento,
inst_origen,
inst_cod_institucion,
estu_horassemanatrabaja,
fami_tienecomputador
from
sbrpro_20121
);
-- INSERT 0 106670
-- select count(*) from sbrpro_2012_2014;
-- 199192
-- ###### A MI ME SALIÓ 199191 registros
--===================================================================================
-- Buscar atributos compatibles(que no se llaman igual pero que su valor es el mismo)
-- entre sbrpro_20121 y sbrpro_2012_2014
-------------------------------------------------------------------------------------
-- Que hay en sbrpro_20121 que no hay en sbrpro_2012_2014
select column_name from information_schema.columns where table_name='sbrpro_20121'
except
select column_name from information_schema.columns where table_name='sbrpro_2012_2014';
/*
"estu_ultimogradoaprobo"
"estu_ano_terminobachiller"
"estu_mes_terminobachiller"
"estu_anoterminoultimogrado"
"estu_graduo_bachiller"
"estu_fechagradobachiller"
"estu_vecespresentoexamen"
-- estos atributos no son relevantes
*/
-----------------------------------------------------------------
-- que hay en sbrpro_2012_2014 que no esta en sbrpro_20121
select column_name from information_schema.columns where table_name='sbrpro_2012_2014'
except
select column_name from information_schema.columns where table_name='sbrpro_20122';
/*
"estu_limita_sordoceguera"
"estu_actividadrefuerzogeneric"
"estu_cursoiesexterna"
"estu_cursoiesapoyoexterno"
"estu_actividadrefuerzoareas"
"estu_tomo_cursopreparacion"
"estu_limita_motriz"
"estu_limita_sordosininterprete"
"estu_etnia"
"estu_cursodocentesies"
"estu_limita_invidente"
"estu_limita_sordoconinterprete"
"estu_simulacrotipoicfes"
*/
-- no hay  atributos compatibles

-- ===================================================================================================
-- Integrar los datos de la tabla sbrpro_20122 a sbrpro_2012_2014
------------------------------------------------------------------------------------------------------
-- Visualizar los atributos comunes de estas dos tablas
select column_name from information_schema.columns where table_name='sbrpro_2012_2014'
intersect
select column_name from information_schema.columns where table_name='sbrpro_20122';
-- 90 comunes
-- 
-- Ingresamos a sbrpro_2012_2014 los datos de las 90 columnas comunes con respecto a sbrpro_20122
insert into sbrpro_2012_2014
(
estu_trabaja_actualmente, 
estu_estadocivil, 
estu_porcentajecreditosaprob,
fami_tieneautomovil, 
fami_nivel_sisben, 
fami_tienelavadora, 
estu_genero, 
estu_metodo_prgm, 
fami_tiene_microondas, 
fami_tiene_serviciotv, 
estu_cod_cole_mcpio_termino, 
estu_cod_mcpio_presentacion, 
estu_tipodocumento, 
estu_prgm_academico, 
estu_otrocole_termino, 
estu_valormatriculauniversidad, 
estu_pagomatriculapadres, 
mod_ingles_punt, 
estu_nivel_prgm_academico, 
estu_nucleo_pregrado, 
estu_cod_reside_mcpio, 
estu_mcpio_reside, 
inst_caracter_academico, 
estu_tipodocumentosb11, 
estu_depto_presentacion, 
estu_inst_departamento, 
fami_personashogar, 
estu_privado_libertad, 
estu_cod_reside_depto, 
mod_razona_cuantitat_punt, 
estu_pagomatriculabeca, 
estu_ano_examenestado_sb11, 
estu_depto_reside, 
estu_actividadrefuerzogeneric, 
estu_pagomatriculapropio, 
mod_competen_ciudada_punt, 
mod_ingles_desem, 
fami_estratovivienda, 
estu_cursoiesexterna, 
estu_cursoiesapoyoexterno, 
estu_inst_municipio, 
fami_ocupacionmadre, 
estu_nacionalidad, 
periodo, 
estu_estudiante, 
estu_snies_prgmacademico, 
estu_actividadrefuerzoareas, 
fami_tiene_nevera, 
estu_tomo_cursopreparacion, 
fami_tieneinternet, 
estu_consecutivo, 
fami_tiene_dvd, 
fami_tiene_horno, 
fami_numpersonasacargo, 
estu_semestre_examenestadosb11, 
mod_comuni_escrita_punt, 
mod_lectura_critica_punt, 
estu_cole_termino, 
estu_estadoinvestigacion, 
fami_educacionpadre, 
estu_tituloobtenidobachiller, 
estu_inst_codmunicipio, 
fami_educacionmadre, 
estu_mcpio_presentacion, 
fami_cuartoshogar, 
estu_pagomatriculacredito, 
gruporeferencia, 
estu_pais_reside, 
fami_cabezafamilia, 
fami_pisos_hogar, 
estu_prgm_codmunicipio, 
estu_cursodocentesies, 
inst_nombre_institucion, 
estu_coddane_cole_termino, 
estu_cod_depto_presentacion, 
fami_hogaractual, 
estu_prgm_departamento, 
fami_tiene_celular, 
fami_ocupacionpadre, 
estu_prgm_municipio, 
mod_comuni_escrita_desem, 
fami_telefono, 
fami_ingreso_fmiliar_mensual, 
estu_semestrecursa, 
estu_fechanacimiento, 
inst_origen, 
inst_cod_institucion, 
estu_horassemanatrabaja, 
fami_tienecomputador, 
estu_simulacrotipoicfes 
)
(
select
estu_trabaja_actualmente, 
estu_estadocivil, 
estu_porcentajecreditosaprob,
fami_tieneautomovil, 
fami_nivel_sisben, 
fami_tienelavadora, 
estu_genero, 
estu_metodo_prgm, 
fami_tiene_microondas, 
fami_tiene_serviciotv, 
estu_cod_cole_mcpio_termino, 
estu_cod_mcpio_presentacion, 
estu_tipodocumento, 
estu_prgm_academico, 
estu_otrocole_termino, 
estu_valormatriculauniversidad, 
estu_pagomatriculapadres, 
mod_ingles_punt, 
estu_nivel_prgm_academico, 
estu_nucleo_pregrado, 
estu_cod_reside_mcpio, 
estu_mcpio_reside, 
inst_caracter_academico, 
estu_tipodocumentosb11, 
estu_depto_presentacion, 
estu_inst_departamento, 
fami_personashogar, 
estu_privado_libertad, 
estu_cod_reside_depto, 
mod_razona_cuantitat_punt, 
estu_pagomatriculabeca, 
estu_ano_examenestado_sb11, 
estu_depto_reside, 
estu_actividadrefuerzogeneric, 
estu_pagomatriculapropio, 
mod_competen_ciudada_punt, 
mod_ingles_desem, 
fami_estratovivienda, 
estu_cursoiesexterna, 
estu_cursoiesapoyoexterno, 
estu_inst_municipio, 
fami_ocupacionmadre, 
estu_nacionalidad, 
periodo, 
estu_estudiante, 
estu_snies_prgmacademico, 
estu_actividadrefuerzoareas, 
fami_tiene_nevera, 
estu_tomo_cursopreparacion, 
fami_tieneinternet, 
estu_consecutivo, 
fami_tiene_dvd, 
fami_tiene_horno, 
fami_numpersonasacargo, 
estu_semestre_examenestadosb11, 
mod_comuni_escrita_punt, 
mod_lectura_critica_punt, 
estu_cole_termino, 
estu_estadoinvestigacion, 
fami_educacionpadre, 
estu_tituloobtenidobachiller, 
estu_inst_codmunicipio, 
fami_educacionmadre, 
estu_mcpio_presentacion, 
fami_cuartoshogar, 
estu_pagomatriculacredito, 
gruporeferencia, 
estu_pais_reside, 
fami_cabezafamilia, 
fami_pisos_hogar, 
estu_prgm_codmunicipio, 
estu_cursodocentesies, 
inst_nombre_institucion, 
estu_coddane_cole_termino, 
estu_cod_depto_presentacion, 
fami_hogaractual, 
estu_prgm_departamento, 
fami_tiene_celular, 
fami_ocupacionpadre, 
estu_prgm_municipio, 
mod_comuni_escrita_desem, 
fami_telefono, 
fami_ingreso_fmiliar_mensual, 
estu_semestrecursa, 
estu_fechanacimiento, 
inst_origen, 
inst_cod_institucion, 
estu_horassemanatrabaja, 
fami_tienecomputador, 
estu_simulacrotipoicfes
from
sbrpro_20122
);
-- INSERT 0 150804
-- select count(*) from sbrpro_2012_2014;
-- 349996
-- #### A MI ME SALE 349995 registros 
--===============================================================================================
-- tarea:integrar sbrpro_2012_2014 con los datos de sbrpro_20131,sbrpro_20132,sbrpro_20141,sbrpro_20142

-- ===================================================================================================
-- Integrar los datos de la tabla sbrpro_20131 a sbrpro_2012_2014
------------------------------------------------------------------------------------------------------
-- Visualizar los atributos comunes de estas dos tablas
select column_name from information_schema.columns where table_name='sbrpro_2012_2014'
intersect
select column_name from information_schema.columns where table_name='sbrpro_20131';
-- 90 atributos comunes
-- 
-- Ingresamos a sbrpro_2012_2014 los datos de las 90 columnas comunes con respecto a sbrpro_20131
insert into sbrpro_2012_2014
(
estu_trabaja_actualmente,
estu_estadocivil,
estu_porcentajecreditosaprob,
fami_tieneautomovil,
fami_nivel_sisben,
fami_tienelavadora,
estu_genero,
estu_metodo_prgm,
fami_tiene_microondas,
fami_tiene_serviciotv,
estu_cod_cole_mcpio_termino,
estu_cod_mcpio_presentacion,
estu_tipodocumento,
estu_prgm_academico,
estu_otrocole_termino,
estu_valormatriculauniversidad,
estu_pagomatriculapadres,
mod_ingles_punt,
estu_nivel_prgm_academico,
estu_nucleo_pregrado,
estu_cod_reside_mcpio,
estu_mcpio_reside,
inst_caracter_academico,
estu_tipodocumentosb11,
estu_depto_presentacion,
estu_inst_departamento,
fami_personashogar,
estu_privado_libertad,
estu_cod_reside_depto,
mod_razona_cuantitat_punt,
estu_pagomatriculabeca,
estu_ano_examenestado_sb11,
estu_depto_reside,
estu_actividadrefuerzogeneric,
estu_pagomatriculapropio,
mod_competen_ciudada_punt,
mod_ingles_desem,
fami_estratovivienda,
estu_cursoiesexterna,
estu_cursoiesapoyoexterno,
estu_inst_municipio,
fami_ocupacionmadre,
estu_nacionalidad,
periodo,
estu_estudiante,
estu_snies_prgmacademico,
estu_actividadrefuerzoareas,
fami_tiene_nevera,
estu_tomo_cursopreparacion,
fami_tieneinternet,
estu_consecutivo,
fami_tiene_dvd,
fami_tiene_horno,
fami_numpersonasacargo,
estu_semestre_examenestadosb11,
mod_comuni_escrita_punt,
mod_lectura_critica_punt,
estu_cole_termino,
estu_estadoinvestigacion,
fami_educacionpadre,
estu_tituloobtenidobachiller,
estu_inst_codmunicipio,
fami_educacionmadre,
estu_mcpio_presentacion,
fami_cuartoshogar,
estu_pagomatriculacredito,
gruporeferencia,
estu_pais_reside,
fami_cabezafamilia,
fami_pisos_hogar,
estu_prgm_codmunicipio,
estu_cursodocentesies,
inst_nombre_institucion,
estu_coddane_cole_termino,
estu_cod_depto_presentacion,
fami_hogaractual,
estu_prgm_departamento,
fami_tiene_celular,
fami_ocupacionpadre,
estu_prgm_municipio,
mod_comuni_escrita_desem,
fami_telefono,
fami_ingreso_fmiliar_mensual,
estu_semestrecursa,
estu_fechanacimiento,
inst_origen,
inst_cod_institucion,
estu_horassemanatrabaja,
fami_tienecomputador,
estu_simulacrotipoicfes 
)
(
select
estu_trabaja_actualmente,
estu_estadocivil,
estu_porcentajecreditosaprob,
fami_tieneautomovil,
fami_nivel_sisben,
fami_tienelavadora,
estu_genero,
estu_metodo_prgm,
fami_tiene_microondas,
fami_tiene_serviciotv,
estu_cod_cole_mcpio_termino,
estu_cod_mcpio_presentacion,
estu_tipodocumento,
estu_prgm_academico,
estu_otrocole_termino,
estu_valormatriculauniversidad,
estu_pagomatriculapadres,
mod_ingles_punt,
estu_nivel_prgm_academico,
estu_nucleo_pregrado,
estu_cod_reside_mcpio,
estu_mcpio_reside,
inst_caracter_academico,
estu_tipodocumentosb11,
estu_depto_presentacion,
estu_inst_departamento,
fami_personashogar,
estu_privado_libertad,
estu_cod_reside_depto,
mod_razona_cuantitat_punt,
estu_pagomatriculabeca,
estu_ano_examenestado_sb11,
estu_depto_reside,
estu_actividadrefuerzogeneric,
estu_pagomatriculapropio,
mod_competen_ciudada_punt,
mod_ingles_desem,
fami_estratovivienda,
estu_cursoiesexterna,
estu_cursoiesapoyoexterno,
estu_inst_municipio,
fami_ocupacionmadre,
estu_nacionalidad,
periodo,
estu_estudiante,
estu_snies_prgmacademico,
estu_actividadrefuerzoareas,
fami_tiene_nevera,
estu_tomo_cursopreparacion,
fami_tieneinternet,
estu_consecutivo,
fami_tiene_dvd,
fami_tiene_horno,
fami_numpersonasacargo,
estu_semestre_examenestadosb11,
mod_comuni_escrita_punt,
mod_lectura_critica_punt,
estu_cole_termino,
estu_estadoinvestigacion,
fami_educacionpadre,
estu_tituloobtenidobachiller,
estu_inst_codmunicipio,
fami_educacionmadre,
estu_mcpio_presentacion,
fami_cuartoshogar,
estu_pagomatriculacredito,
gruporeferencia,
estu_pais_reside,
fami_cabezafamilia,
fami_pisos_hogar,
estu_prgm_codmunicipio,
estu_cursodocentesies,
inst_nombre_institucion,
estu_coddane_cole_termino,
estu_cod_depto_presentacion,
fami_hogaractual,
estu_prgm_departamento,
fami_tiene_celular,
fami_ocupacionpadre,
estu_prgm_municipio,
mod_comuni_escrita_desem,
fami_telefono,
fami_ingreso_fmiliar_mensual,
estu_semestrecursa,
estu_fechanacimiento,
inst_origen,
inst_cod_institucion,
estu_horassemanatrabaja,
fami_tienecomputador,
estu_simulacrotipoicfes
from
sbrpro_20131
);
-- INSERT 0 124608
-- select count(*) from sbrpro_2012_2014;
-- 474603
--===============================================================================================

-- ===================================================================================================
-- Integrar los datos de la tabla sbrpro_20132 a sbrpro_2012_2014
------------------------------------------------------------------------------------------------------
-- Visualizar los atributos comunes de estas dos tablas
select column_name from information_schema.columns where table_name='sbrpro_2012_2014'
intersect
select column_name from information_schema.columns where table_name='sbrpro_20132';
-- 96 atributos comunes
-- 
-- Ingresamos a sbrpro_2012_2014 los datos de las 90 columnas comunes con respecto a sbrpro_20132
insert into sbrpro_2012_2014
(
estu_trabaja_actualmente,
estu_estadocivil,
estu_porcentajecreditosaprob,
fami_tieneautomovil,
fami_nivel_sisben,
fami_tienelavadora,
estu_genero,
estu_metodo_prgm,
fami_tiene_microondas,
fami_tiene_serviciotv,
estu_cod_cole_mcpio_termino,
estu_cod_mcpio_presentacion,
estu_tipodocumento,
estu_prgm_academico,
estu_otrocole_termino,
estu_valormatriculauniversidad,
estu_pagomatriculapadres,
mod_ingles_punt,
estu_nivel_prgm_academico,
estu_nucleo_pregrado,
estu_cod_reside_mcpio,
estu_mcpio_reside,
inst_caracter_academico,
estu_tipodocumentosb11,
estu_depto_presentacion,
estu_inst_departamento,
fami_personashogar,
estu_privado_libertad,
estu_cod_reside_depto,
mod_razona_cuantitat_punt,
estu_pagomatriculabeca,
estu_ano_examenestado_sb11,
estu_depto_reside,
estu_limita_sordoceguera,
estu_actividadrefuerzogeneric,
estu_pagomatriculapropio,
mod_competen_ciudada_punt,
mod_ingles_desem,
fami_estratovivienda,
estu_cursoiesexterna,
estu_cursoiesapoyoexterno,
estu_inst_municipio,
fami_ocupacionmadre,
estu_nacionalidad,
periodo,
estu_estudiante,
estu_snies_prgmacademico,
estu_actividadrefuerzoareas,
fami_tiene_nevera,
estu_tomo_cursopreparacion,
fami_tieneinternet,
estu_consecutivo,
fami_tiene_dvd,
fami_tiene_horno,
fami_numpersonasacargo,
estu_semestre_examenestadosb11,
mod_comuni_escrita_punt,
mod_lectura_critica_punt,
estu_cole_termino,
estu_limita_motriz,
estu_estadoinvestigacion,
estu_limita_sordosininterprete,
fami_educacionpadre,
estu_tituloobtenidobachiller,
estu_inst_codmunicipio,
fami_educacionmadre,
estu_mcpio_presentacion,
estu_etnia,
fami_cuartoshogar,
estu_pagomatriculacredito,
gruporeferencia,
estu_pais_reside,
fami_cabezafamilia,
fami_pisos_hogar,
estu_prgm_codmunicipio,
estu_cursodocentesies,
inst_nombre_institucion,
estu_coddane_cole_termino,
estu_cod_depto_presentacion,
fami_hogaractual,
estu_prgm_departamento,
fami_tiene_celular,
fami_ocupacionpadre,
estu_prgm_municipio,
mod_comuni_escrita_desem,
fami_telefono,
fami_ingreso_fmiliar_mensual,
estu_semestrecursa,
estu_limita_invidente,
estu_fechanacimiento,
estu_limita_sordoconinterprete,
inst_origen,
inst_cod_institucion,
estu_horassemanatrabaja,
fami_tienecomputador,
estu_simulacrotipoicfes 
)
(
select
estu_trabaja_actualmente,
estu_estadocivil,
estu_porcentajecreditosaprob,
fami_tieneautomovil,
fami_nivel_sisben,
fami_tienelavadora,
estu_genero,
estu_metodo_prgm,
fami_tiene_microondas,
fami_tiene_serviciotv,
estu_cod_cole_mcpio_termino,
estu_cod_mcpio_presentacion,
estu_tipodocumento,
estu_prgm_academico,
estu_otrocole_termino,
estu_valormatriculauniversidad,
estu_pagomatriculapadres,
mod_ingles_punt,
estu_nivel_prgm_academico,
estu_nucleo_pregrado,
estu_cod_reside_mcpio,
estu_mcpio_reside,
inst_caracter_academico,
estu_tipodocumentosb11,
estu_depto_presentacion,
estu_inst_departamento,
fami_personashogar,
estu_privado_libertad,
estu_cod_reside_depto,
mod_razona_cuantitat_punt,
estu_pagomatriculabeca,
estu_ano_examenestado_sb11,
estu_depto_reside,
estu_limita_sordoceguera,
estu_actividadrefuerzogeneric,
estu_pagomatriculapropio,
mod_competen_ciudada_punt,
mod_ingles_desem,
fami_estratovivienda,
estu_cursoiesexterna,
estu_cursoiesapoyoexterno,
estu_inst_municipio,
fami_ocupacionmadre,
estu_nacionalidad,
periodo,
estu_estudiante,
estu_snies_prgmacademico,
estu_actividadrefuerzoareas,
fami_tiene_nevera,
estu_tomo_cursopreparacion,
fami_tieneinternet,
estu_consecutivo,
fami_tiene_dvd,
fami_tiene_horno,
fami_numpersonasacargo,
estu_semestre_examenestadosb11,
mod_comuni_escrita_punt,
mod_lectura_critica_punt,
estu_cole_termino,
estu_limita_motriz,
estu_estadoinvestigacion,
estu_limita_sordosininterprete,
fami_educacionpadre,
estu_tituloobtenidobachiller,
estu_inst_codmunicipio,
fami_educacionmadre,
estu_mcpio_presentacion,
estu_etnia,
fami_cuartoshogar,
estu_pagomatriculacredito,
gruporeferencia,
estu_pais_reside,
fami_cabezafamilia,
fami_pisos_hogar,
estu_prgm_codmunicipio,
estu_cursodocentesies,
inst_nombre_institucion,
estu_coddane_cole_termino,
estu_cod_depto_presentacion,
fami_hogaractual,
estu_prgm_departamento,
fami_tiene_celular,
fami_ocupacionpadre,
estu_prgm_municipio,
mod_comuni_escrita_desem,
fami_telefono,
fami_ingreso_fmiliar_mensual,
estu_semestrecursa,
estu_limita_invidente,
estu_fechanacimiento,
estu_limita_sordoconinterprete,
inst_origen,
inst_cod_institucion,
estu_horassemanatrabaja,
fami_tienecomputador,
estu_simulacrotipoicfes
from
sbrpro_20132
);
-- INSERT 0 188926
-- select count(*) from sbrpro_2012_2014;
-- 663529
--===============================================================================================

/*
 ###### NO SE DEBE INTEGRAR PORQUE LA TABLA NUEVA ES EN REFERENCIA A ESTA, ES LA MISMA
-- ===================================================================================================
-- Integrar los datos de la tabla sbrpro_20141 a sbrpro_2012_2014
------------------------------------------------------------------------------------------------------
-- Visualizar los atributos comunes de estas dos tablas
select column_name from information_schema.columns where table_name='sbrpro_2012_2014'
intersect
select column_name from information_schema.columns where table_name='sbrpro_20141';
-- 96 atributos comunes
-- 
-- Ingresamos a sbrpro_2012_2014 los datos de las 90 columnas comunes con respecto a sbrpro_20141
insert into sbrpro_2012_2014
(
estu_trabaja_actualmente,
estu_estadocivil,
estu_porcentajecreditosaprob,
fami_tieneautomovil,
fami_nivel_sisben,
fami_tienelavadora,
estu_genero,
estu_metodo_prgm,
fami_tiene_microondas,
fami_tiene_serviciotv,
estu_cod_cole_mcpio_termino,
estu_cod_mcpio_presentacion,
estu_tipodocumento,
estu_prgm_academico,
estu_otrocole_termino,
estu_valormatriculauniversidad,
estu_pagomatriculapadres,
mod_ingles_punt,
estu_nivel_prgm_academico,
estu_nucleo_pregrado,
estu_cod_reside_mcpio,
estu_mcpio_reside,
inst_caracter_academico,
estu_tipodocumentosb11,
estu_depto_presentacion,
estu_inst_departamento,
fami_personashogar,
estu_privado_libertad,
estu_cod_reside_depto,
mod_razona_cuantitat_punt,
estu_pagomatriculabeca,
estu_ano_examenestado_sb11,
estu_depto_reside,
estu_limita_sordoceguera,
estu_actividadrefuerzogeneric,
estu_pagomatriculapropio,
mod_competen_ciudada_punt,
mod_ingles_desem,
fami_estratovivienda,
estu_cursoiesexterna,
estu_cursoiesapoyoexterno,
estu_inst_municipio,
fami_ocupacionmadre,
estu_nacionalidad,
periodo,
estu_estudiante,
estu_snies_prgmacademico,
estu_actividadrefuerzoareas,
fami_tiene_nevera,
estu_tomo_cursopreparacion,
fami_tieneinternet,
estu_consecutivo,
fami_tiene_dvd,
fami_tiene_horno,
fami_numpersonasacargo,
estu_semestre_examenestadosb11,
mod_comuni_escrita_punt,
mod_lectura_critica_punt,
estu_cole_termino,
estu_limita_motriz,
estu_estadoinvestigacion,
estu_limita_sordosininterprete,
fami_educacionpadre,
estu_tituloobtenidobachiller,
estu_inst_codmunicipio,
fami_educacionmadre,
estu_mcpio_presentacion,
estu_etnia,
fami_cuartoshogar,
estu_pagomatriculacredito,
gruporeferencia,
estu_pais_reside,
fami_cabezafamilia,
fami_pisos_hogar,
estu_prgm_codmunicipio,
estu_cursodocentesies,
inst_nombre_institucion,
estu_coddane_cole_termino,
estu_cod_depto_presentacion,
fami_hogaractual,
estu_prgm_departamento,
fami_tiene_celular,
fami_ocupacionpadre,
estu_prgm_municipio,
mod_comuni_escrita_desem,
fami_telefono,
fami_ingreso_fmiliar_mensual,
estu_semestrecursa,
estu_limita_invidente,
estu_fechanacimiento,
estu_limita_sordoconinterprete,
inst_origen,
inst_cod_institucion,
estu_horassemanatrabaja,
fami_tienecomputador,
estu_simulacrotipoicfes 
)
(
select
estu_trabaja_actualmente,
estu_estadocivil,
estu_porcentajecreditosaprob,
fami_tieneautomovil,
fami_nivel_sisben,
fami_tienelavadora,
estu_genero,
estu_metodo_prgm,
fami_tiene_microondas,
fami_tiene_serviciotv,
estu_cod_cole_mcpio_termino,
estu_cod_mcpio_presentacion,
estu_tipodocumento,
estu_prgm_academico,
estu_otrocole_termino,
estu_valormatriculauniversidad,
estu_pagomatriculapadres,
mod_ingles_punt,
estu_nivel_prgm_academico,
estu_nucleo_pregrado,
estu_cod_reside_mcpio,
estu_mcpio_reside,
inst_caracter_academico,
estu_tipodocumentosb11,
estu_depto_presentacion,
estu_inst_departamento,
fami_personashogar,
estu_privado_libertad,
estu_cod_reside_depto,
mod_razona_cuantitat_punt,
estu_pagomatriculabeca,
estu_ano_examenestado_sb11,
estu_depto_reside,
estu_limita_sordoceguera,
estu_actividadrefuerzogeneric,
estu_pagomatriculapropio,
mod_competen_ciudada_punt,
mod_ingles_desem,
fami_estratovivienda,
estu_cursoiesexterna,
estu_cursoiesapoyoexterno,
estu_inst_municipio,
fami_ocupacionmadre,
estu_nacionalidad,
periodo,
estu_estudiante,
estu_snies_prgmacademico,
estu_actividadrefuerzoareas,
fami_tiene_nevera,
estu_tomo_cursopreparacion,
fami_tieneinternet,
estu_consecutivo,
fami_tiene_dvd,
fami_tiene_horno,
fami_numpersonasacargo,
estu_semestre_examenestadosb11,
mod_comuni_escrita_punt,
mod_lectura_critica_punt,
estu_cole_termino,
estu_limita_motriz,
estu_estadoinvestigacion,
estu_limita_sordosininterprete,
fami_educacionpadre,
estu_tituloobtenidobachiller,
estu_inst_codmunicipio,
fami_educacionmadre,
estu_mcpio_presentacion,
estu_etnia,
fami_cuartoshogar,
estu_pagomatriculacredito,
gruporeferencia,
estu_pais_reside,
fami_cabezafamilia,
fami_pisos_hogar,
estu_prgm_codmunicipio,
estu_cursodocentesies,
inst_nombre_institucion,
estu_coddane_cole_termino,
estu_cod_depto_presentacion,
fami_hogaractual,
estu_prgm_departamento,
fami_tiene_celular,
fami_ocupacionpadre,
estu_prgm_municipio,
mod_comuni_escrita_desem,
fami_telefono,
fami_ingreso_fmiliar_mensual,
estu_semestrecursa,
estu_limita_invidente,
estu_fechanacimiento,
estu_limita_sordoconinterprete,
inst_origen,
inst_cod_institucion,
estu_horassemanatrabaja,
fami_tienecomputador,
estu_simulacrotipoicfes
from
sbrpro_20141
);
--  ###### NO SE DEBE INTEGRAR PORQUE LA TABLA NUEVA ES EN REFERENCIA A ESTA
-- select count(*) from sbrpro_2012_2014;	###### NO SE DEBE INTEGRAR PORQUE LA TABLA NUEVA ES EN REFERENCIA A ESTA
-- 	###### NO SE DEBE INTEGRAR PORQUE LA TABLA NUEVA ES EN REFERENCIA A ESTA
-- =============================================================================================== */

-- ===================================================================================================
-- Integrar los datos de la tabla sbrpro_20142 a sbrpro_2012_2014
------------------------------------------------------------------------------------------------------
-- Visualizar los atributos comunes de estas dos tablas
select column_name from information_schema.columns where table_name='sbrpro_2012_2014'
intersect
select column_name from information_schema.columns where table_name='sbrpro_20142';
-- 96 atributos comunes
-- 
-- Ingresamos a sbrpro_2012_2014 los datos de las 90 columnas comunes con respecto a sbrpro_20142
insert into sbrpro_2012_2014
(
estu_trabaja_actualmente,
estu_estadocivil,
estu_porcentajecreditosaprob,
fami_tieneautomovil,
fami_nivel_sisben,
fami_tienelavadora,
estu_genero,
estu_metodo_prgm,
fami_tiene_microondas,
fami_tiene_serviciotv,
estu_cod_cole_mcpio_termino,
estu_cod_mcpio_presentacion,
estu_tipodocumento,
estu_prgm_academico,
estu_otrocole_termino,
estu_valormatriculauniversidad,
estu_pagomatriculapadres,
mod_ingles_punt,
estu_nivel_prgm_academico,
estu_nucleo_pregrado,
estu_cod_reside_mcpio,
estu_mcpio_reside,
inst_caracter_academico,
estu_tipodocumentosb11,
estu_depto_presentacion,
estu_inst_departamento,
fami_personashogar,
estu_privado_libertad,
estu_cod_reside_depto,
mod_razona_cuantitat_punt,
estu_pagomatriculabeca,
estu_ano_examenestado_sb11,
estu_depto_reside,
estu_limita_sordoceguera,
estu_actividadrefuerzogeneric,
estu_pagomatriculapropio,
mod_competen_ciudada_punt,
mod_ingles_desem,
fami_estratovivienda,
estu_cursoiesexterna,
estu_cursoiesapoyoexterno,
estu_inst_municipio,
fami_ocupacionmadre,
estu_nacionalidad,
periodo,
estu_estudiante,
estu_snies_prgmacademico,
estu_actividadrefuerzoareas,
fami_tiene_nevera,
estu_tomo_cursopreparacion,
fami_tieneinternet,
estu_consecutivo,
fami_tiene_dvd,
fami_tiene_horno,
fami_numpersonasacargo,
estu_semestre_examenestadosb11,
mod_comuni_escrita_punt,
mod_lectura_critica_punt,
estu_cole_termino,
estu_limita_motriz,
estu_estadoinvestigacion,
estu_limita_sordosininterprete,
fami_educacionpadre,
estu_tituloobtenidobachiller,
estu_inst_codmunicipio,
fami_educacionmadre,
estu_mcpio_presentacion,
estu_etnia,
fami_cuartoshogar,
estu_pagomatriculacredito,
gruporeferencia,
estu_pais_reside,
fami_cabezafamilia,
fami_pisos_hogar,
estu_prgm_codmunicipio,
estu_cursodocentesies,
inst_nombre_institucion,
estu_coddane_cole_termino,
estu_cod_depto_presentacion,
fami_hogaractual,
estu_prgm_departamento,
fami_tiene_celular,
fami_ocupacionpadre,
estu_prgm_municipio,
mod_comuni_escrita_desem,
fami_telefono,
fami_ingreso_fmiliar_mensual,
estu_semestrecursa,
estu_limita_invidente,
estu_fechanacimiento,
estu_limita_sordoconinterprete,
inst_origen,
inst_cod_institucion,
estu_horassemanatrabaja,
fami_tienecomputador,
estu_simulacrotipoicfes 
)
(
select
estu_trabaja_actualmente,
estu_estadocivil,
estu_porcentajecreditosaprob,
fami_tieneautomovil,
fami_nivel_sisben,
fami_tienelavadora,
estu_genero,
estu_metodo_prgm,
fami_tiene_microondas,
fami_tiene_serviciotv,
estu_cod_cole_mcpio_termino,
estu_cod_mcpio_presentacion,
estu_tipodocumento,
estu_prgm_academico,
estu_otrocole_termino,
estu_valormatriculauniversidad,
estu_pagomatriculapadres,
mod_ingles_punt,
estu_nivel_prgm_academico,
estu_nucleo_pregrado,
estu_cod_reside_mcpio,
estu_mcpio_reside,
inst_caracter_academico,
estu_tipodocumentosb11,
estu_depto_presentacion,
estu_inst_departamento,
fami_personashogar,
estu_privado_libertad,
estu_cod_reside_depto,
mod_razona_cuantitat_punt,
estu_pagomatriculabeca,
estu_ano_examenestado_sb11,
estu_depto_reside,
estu_limita_sordoceguera,
estu_actividadrefuerzogeneric,
estu_pagomatriculapropio,
mod_competen_ciudada_punt,
mod_ingles_desem,
fami_estratovivienda,
estu_cursoiesexterna,
estu_cursoiesapoyoexterno,
estu_inst_municipio,
fami_ocupacionmadre,
estu_nacionalidad,
periodo,
estu_estudiante,
estu_snies_prgmacademico,
estu_actividadrefuerzoareas,
fami_tiene_nevera,
estu_tomo_cursopreparacion,
fami_tieneinternet,
estu_consecutivo,
fami_tiene_dvd,
fami_tiene_horno,
fami_numpersonasacargo,
estu_semestre_examenestadosb11,
mod_comuni_escrita_punt,
mod_lectura_critica_punt,
estu_cole_termino,
estu_limita_motriz,
estu_estadoinvestigacion,
estu_limita_sordosininterprete,
fami_educacionpadre,
estu_tituloobtenidobachiller,
estu_inst_codmunicipio,
fami_educacionmadre,
estu_mcpio_presentacion,
estu_etnia,
fami_cuartoshogar,
estu_pagomatriculacredito,
gruporeferencia,
estu_pais_reside,
fami_cabezafamilia,
fami_pisos_hogar,
estu_prgm_codmunicipio,
estu_cursodocentesies,
inst_nombre_institucion,
estu_coddane_cole_termino,
estu_cod_depto_presentacion,
fami_hogaractual,
estu_prgm_departamento,
fami_tiene_celular,
fami_ocupacionpadre,
estu_prgm_municipio,
mod_comuni_escrita_desem,
fami_telefono,
fami_ingreso_fmiliar_mensual,
estu_semestrecursa,
estu_limita_invidente,
estu_fechanacimiento,
estu_limita_sordoconinterprete,
inst_origen,
inst_cod_institucion,
estu_horassemanatrabaja,
fami_tienecomputador,
estu_simulacrotipoicfes
from
sbrpro_20142
);
-- INSERT 0 256833
-- select count(*) from sbrpro_2012_2014;
-- 920362 REGISTROS
-- ===============================================================================================